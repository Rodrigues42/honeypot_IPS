[Definition]

# Fail2Ban filter para detectar comandos maliciosos no Cowrie
# Formato JSON: {"eventid":"cowrie.command.input","input":"wget http://...","src_ip":"IP",...}
# Ordem real: eventid, input, message, sensor, uuid, timestamp, src_ip

# Regex ajustada para a ordem correta dos campos no JSON do Cowrie
# O src_ip está no final da linha, não no meio

# Regex corrigida - src_ip está no final, input vem antes
failregex = ^.*"eventid":"cowrie\.command\.input".*"input":"[^"]*(wget|curl|tftp|busybox|ftpget|ftp.*get|chmod\s*\+x|\.\/|sh\s|/tmp/|authorized_keys|adduser|useradd|passwd.*root|nmap|xmrig|miner|;|&&|>|<|\|).*".*"src_ip":"<HOST>".*$

# Ignorar linhas irrelevantes
ignoreregex = 
